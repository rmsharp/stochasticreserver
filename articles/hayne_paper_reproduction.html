<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reproducing Hayne’s Flexible Framework for Stochastic Reserving Models • stochasticreserver</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="hayne_paper_reproduction_files/libs/quarto-html/popper.min.js"></script><script src="hayne_paper_reproduction_files/libs/quarto-html/tippy.umd.min.js"></script><link href="hayne_paper_reproduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hayne_paper_reproduction_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproducing Hayne’s Flexible Framework for Stochastic Reserving Models">
<style>
.code-fold-btn {
  cursor: pointer;
  padding: 0.25em 0.5em;
  background-color: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 0.25rem;
  margin-bottom: 0.5em;
  font-size: 0.85em;
  display: inline-block;
}
.code-fold-btn:hover {
  background-color: #e9ecef;
}
.sourceCode.hidden {
  display: none;
}
</style>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stochasticreserver</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/comprehensive_tutorial.html">Comprehensive Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/hayne_paper_reproduction.html">Hayne Paper Reproduction</a></li>
    <li><a class="dropdown-item" href="../articles/stochastic_reserving.html">Example Stochastic Reserving</a></li>
    <li><a class="dropdown-item" href="../articles/manual.html">Manual</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reproducing Hayne’s Flexible Framework for Stochastic Reserving Models</h1>

      <p class="author">R. Mark Sharp</p>
      <p class="date">2026-01-21</p>


      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2" data-number="1"><h2 data-number="1" id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette reproduces the key results from Roger Hayne’s paper “A Flexible Framework for Stochastic Reserving Models” published in <em>Variance</em> journal <span class="citation" data-cites="hayne2012">(<a href="#ref-hayne2012" role="doc-biblioref">Hayne 2012</a>)</span>. The paper is available at:</p>
<ul>
<li><a href="https://variancejournal.org/article/120823" class="external-link">Variance Journal</a></li>
<li><a href="https://www.casact.org/sites/default/files/2021-08/Flexible-Framework-Hayne.pdf" class="external-link">CAS PDF</a></li>
</ul>
<p>The <code>stochasticreserver</code> package implements all five reserving models described in the paper using a unified maximum likelihood estimation framework.</p>
</section><section class="level2" data-number="2"><h2 data-number="2" id="theoretical-framework">
<span class="header-section-number">2</span> Theoretical Framework<a class="anchor" aria-label="anchor" href="#theoretical-framework"></a>
</h2>
<section class="level3" data-number="2.1"><h3 data-number="2.1" id="the-stochastic-model">
<span class="header-section-number">2.1</span> The Stochastic Model<a class="anchor" aria-label="anchor" href="#the-stochastic-model"></a>
</h3>
<p>Hayne’s framework treats incremental average loss amounts as random variables following a normal distribution. For accident year <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> and development lag <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A_{ij} \sim N(g_{ij}(\theta), \sigma^2_{ij})</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">A_{ij}</annotation></semantics></math> is the observed incremental average</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_{ij}(\theta)</annotation></semantics></math> is the expected value function (model-specific)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_{ij}</annotation></semantics></math> is the variance</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math> is the parameter vector</li>
</ul></section><section class="level3" data-number="2.2"><h3 data-number="2.2" id="variance-structure">
<span class="header-section-number">2.2</span> Variance Structure<a class="anchor" aria-label="anchor" href="#variance-structure"></a>
</h3>
<p>The variance follows a power model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo>=</mo><msup><mi>e</mi><mrow><mi>κ</mi><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub></mrow></msup><mo>⋅</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">\sigma^2_{ij} = e^{\kappa - w_i} \cdot (g_{ij}(\theta)^2)^p</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math> is a proportionality constant</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_i = \log(d_i)</annotation></semantics></math> with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math> being the exposure count for year <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> is a power parameter (0 = constant variance, 0.5 = Poisson-like, 1 = constant CV)</li>
</ul></section><section class="level3" data-number="2.3"><h3 data-number="2.3" id="maximum-likelihood-estimation">
<span class="header-section-number">2.3</span> Maximum Likelihood Estimation<a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation"></a>
</h3>
<p>The log-likelihood function for the observed data is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ln</mo><mi>L</mi><mo>=</mo><mi>−</mi><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">[</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>π</mi><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\ln L = -\frac{1}{2} \sum_{i,j} \left[ \ln(2\pi\sigma^2_{ij}) + \frac{(A_{ij} - g_{ij}(\theta))^2}{\sigma^2_{ij}} \right]</annotation></semantics></math></p>
<p>The negative log-likelihood is minimized to obtain parameter estimates.</p>
</section><section class="level3" data-number="2.4"><h3 data-number="2.4" id="gradient-of-the-objective-function">
<span class="header-section-number">2.4</span> Gradient of the Objective Function<a class="anchor" aria-label="anchor" href="#gradient-of-the-objective-function"></a>
</h3>
<p>The gradient (first derivatives) is required for efficient optimization:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mo>ln</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><msub><mi>θ</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>∂</mi><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi>∂</mi><msub><mi>θ</mi><mi>k</mi></msub></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>p</mi><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mfrac><mo>+</mo><mfrac><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mfrac><mo>−</mo><mfrac><mrow><mi>p</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mrow><msubsup><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial(-\ln L)}{\partial\theta_k} = \sum_{i,j} \left[ \frac{\partial g_{ij}}{\partial\theta_k} \left( \frac{p}{g_{ij}} + \frac{g_{ij} - A_{ij}}{\sigma^2_{ij}} - \frac{p(A_{ij} - g_{ij})^2}{\sigma^2_{ij} g_{ij}} \right) \right]</annotation></semantics></math></p>
</section><section class="level3" data-number="2.5"><h3 data-number="2.5" id="hessian-and-fisher-information">
<span class="header-section-number">2.5</span> Hessian and Fisher Information<a class="anchor" aria-label="anchor" href="#hessian-and-fisher-information"></a>
</h3>
<p>The Hessian matrix (second derivatives) provides the Fisher information:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mfrac><mrow><msup><mi>∂</mi><mn>2</mn></msup><mo>ln</mo><mi>L</mi></mrow><mrow><mi>∂</mi><msub><mi>θ</mi><mi>k</mi></msub><mi>∂</mi><msub><mi>θ</mi><mi>l</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">I(\theta) = E\left[-\frac{\partial^2 \ln L}{\partial\theta_k \partial\theta_l}\right]</annotation></semantics></math></p>
<p>The inverse of the Fisher information matrix gives the variance-covariance matrix for parameter estimates, enabling uncertainty quantification:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mi>I</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\text{Var}(\hat{\theta}) \approx I(\hat{\theta})^{-1}</annotation></semantics></math></p>
</section></section><section class="level2" data-number="3"><h2 data-number="3" id="the-five-reserving-models">
<span class="header-section-number">3</span> The Five Reserving Models<a class="anchor" aria-label="anchor" href="#the-five-reserving-models"></a>
</h2>
<p>Each model specifies a different form for the expected value function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_{ij}(\theta)</annotation></semantics></math>.</p>
<section class="level3" data-number="3.1"><h3 data-number="3.1" id="chain-ladder-model">
<span class="header-section-number">3.1</span> Chain Ladder Model<a class="anchor" aria-label="anchor" href="#chain-ladder-model"></a>
</h3>
<p>The Chain Ladder method assumes development follows a multiplicative pattern:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">g_{ij}(\theta) = \alpha_i \cdot \beta_j</annotation></semantics></math></p>
<p>with constraints:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>β</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_j \beta_j = 1</annotation></semantics></math> (development factors sum to 1)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math> represents ultimate loss for year <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
</ul>
<p><strong>Parameters:</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2n - 1</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> is the triangle size (row and column factors minus one constraint).</p>
</section><section class="level3" data-number="3.2"><h3 data-number="3.2" id="cape-cod-model">
<span class="header-section-number">3.2</span> Cape Cod Model<a class="anchor" aria-label="anchor" href="#cape-cod-model"></a>
</h3>
<p>The Cape Cod (Bornhuetter-Ferguson variant) method:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><msub><mi>d</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">g_{ij}(\theta) = \alpha \cdot d_i \cdot \beta_j</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> is a single expected loss ratio parameter</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math> is the exposure for year <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math> is the development pattern</li>
</ul>
<p><strong>Parameters:</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math> (one loss ratio plus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> development factors).</p>
</section><section class="level3" data-number="3.3"><h3 data-number="3.3" id="berquist-sherman-model">
<span class="header-section-number">3.3</span> Berquist-Sherman Model<a class="anchor" aria-label="anchor" href="#berquist-sherman-model"></a>
</h3>
<p>The Berquist-Sherman incremental severity method includes a trend parameter:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mi>τ</mi><mo>⋅</mo><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>γ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">g_{ij}(\theta) = e^{\tau \cdot i} \cdot \gamma_j</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math> is the trend parameter</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_j</annotation></semantics></math> represents incremental severity by lag</li>
</ul>
<p><strong>Parameters:</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math> (trend plus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> severity factors).</p>
</section><section class="level3" data-number="3.4"><h3 data-number="3.4" id="hoerl-curve-model">
<span class="header-section-number">3.4</span> Hoerl Curve Model<a class="anchor" aria-label="anchor" href="#hoerl-curve-model"></a>
</h3>
<p>The Hoerl curve provides a smooth parametric form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>j</mi><mi>β</mi></msup><mo>⋅</mo><msup><mi>e</mi><mrow><mi>−</mi><mi>γ</mi><mi>j</mi></mrow></msup></mrow><annotation encoding="application/x-tex">g_{ij}(\theta) = \alpha \cdot j^{\beta} \cdot e^{-\gamma j}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> is a scale parameter</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> controls the shape (rise)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math> controls the decay rate</li>
</ul>
<p><strong>Parameters:</strong> 3 (highly parsimonious).</p>
</section><section class="level3" data-number="3.5"><h3 data-number="3.5" id="wright-model">
<span class="header-section-number">3.5</span> Wright Model<a class="anchor" aria-label="anchor" href="#wright-model"></a>
</h3>
<p>The Wright model generalizes Hoerl with individual accident year levels:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>⋅</mo><msup><mi>j</mi><mi>β</mi></msup><mo>⋅</mo><msup><mi>e</mi><mrow><mi>−</mi><mi>γ</mi><mi>j</mi></mrow></msup></mrow><annotation encoding="application/x-tex">g_{ij}(\theta) = \alpha_i \cdot j^{\beta} \cdot e^{-\gamma j}</annotation></semantics></math></p>
<p>where each accident year <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> has its own level <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math> but shares the shape parameters.</p>
<p><strong>Parameters:</strong> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n + 2</annotation></semantics></math> (individual levels plus shared shape parameters).</p>
</section></section><section class="level2" data-number="4"><h2 data-number="4" id="data-from-the-paper">
<span class="header-section-number">4</span> Data from the Paper<a class="anchor" aria-label="anchor" href="#data-from-the-paper"></a>
</h2>
<p>The package includes the development triangle from Table 1 of Hayne’s paper:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">B0</span>, package <span class="op">=</span> <span class="st">"stochasticreserver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">A0</span>, package <span class="op">=</span> <span class="st">"stochasticreserver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dnom</span>, package <span class="op">=</span> <span class="st">"stochasticreserver"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">B0</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<section class="level3" data-number="4.1"><h3 data-number="4.1" id="table-1-development-triangle-cumulative">
<span class="header-section-number">4.1</span> Table 1: Development Triangle (Cumulative)<a class="anchor" aria-label="anchor" href="#table-1-development-triangle-cumulative"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the cumulative triangle</span></span>
<span><span class="va">cumulative</span> <span class="op">&lt;-</span> <span class="va">B0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">size</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cumulative</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">B0</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">j</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">cumulative</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">B0</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cumulative</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Table 1: Cumulative Development Triangle"</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Lag "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top" style="width:100%;">
<caption>Table 1: Cumulative Development Triangle</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">Lag 1</th>
<th style="text-align: right;">Lag 2</th>
<th style="text-align: right;">Lag 3</th>
<th style="text-align: right;">Lag 4</th>
<th style="text-align: right;">Lag 5</th>
<th style="text-align: right;">Lag 6</th>
<th style="text-align: right;">Lag 7</th>
<th style="text-align: right;">Lag 8</th>
<th style="text-align: right;">Lag 9</th>
<th style="text-align: right;">Lag 10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">670.26</td>
<td style="text-align: right;">2150.51</td>
<td style="text-align: right;">4089.04</td>
<td style="text-align: right;">6555.30</td>
<td style="text-align: right;">9393.15</td>
<td style="text-align: right;">12396.67</td>
<td style="text-align: right;">15452.06</td>
<td style="text-align: right;">18585.00</td>
<td style="text-align: right;">21726.18</td>
<td style="text-align: right;">24885.91</td>
</tr>
<tr class="even">
<td style="text-align: right;">767.99</td>
<td style="text-align: right;">2360.49</td>
<td style="text-align: right;">4824.29</td>
<td style="text-align: right;">7844.01</td>
<td style="text-align: right;">11218.73</td>
<td style="text-align: right;">14772.35</td>
<td style="text-align: right;">18374.62</td>
<td style="text-align: right;">22001.91</td>
<td style="text-align: right;">25647.47</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">740.58</td>
<td style="text-align: right;">2356.38</td>
<td style="text-align: right;">4702.23</td>
<td style="text-align: right;">7612.75</td>
<td style="text-align: right;">10814.27</td>
<td style="text-align: right;">14231.99</td>
<td style="text-align: right;">17738.57</td>
<td style="text-align: right;">21267.58</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">862.12</td>
<td style="text-align: right;">2617.02</td>
<td style="text-align: right;">5151.80</td>
<td style="text-align: right;">8422.65</td>
<td style="text-align: right;">12162.54</td>
<td style="text-align: right;">16165.55</td>
<td style="text-align: right;">20290.85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">840.94</td>
<td style="text-align: right;">2699.97</td>
<td style="text-align: right;">5504.51</td>
<td style="text-align: right;">8949.86</td>
<td style="text-align: right;">12900.33</td>
<td style="text-align: right;">17086.28</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">848.00</td>
<td style="text-align: right;">2900.93</td>
<td style="text-align: right;">5977.06</td>
<td style="text-align: right;">9838.10</td>
<td style="text-align: right;">14189.67</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">901.77</td>
<td style="text-align: right;">2829.66</td>
<td style="text-align: right;">5833.25</td>
<td style="text-align: right;">9714.67</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">935.20</td>
<td style="text-align: right;">3039.18</td>
<td style="text-align: right;">6220.93</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">759.32</td>
<td style="text-align: right;">2344.24</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">723.30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3" data-number="4.2"><h3 data-number="4.2" id="incremental-averages">
<span class="header-section-number">4.2</span> Incremental Averages<a class="anchor" aria-label="anchor" href="#incremental-averages"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">A0</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Incremental Average Amounts (A0)"</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Lag "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top">
<caption>Incremental Average Amounts (A0)</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">Lag 1</th>
<th style="text-align: right;">Lag 2</th>
<th style="text-align: right;">Lag 3</th>
<th style="text-align: right;">Lag 4</th>
<th style="text-align: right;">Lag 5</th>
<th style="text-align: right;">Lag 6</th>
<th style="text-align: right;">Lag 7</th>
<th style="text-align: right;">Lag 8</th>
<th style="text-align: right;">Lag 9</th>
<th style="text-align: right;">Lag 10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">670.2587</td>
<td style="text-align: right;">809.9895</td>
<td style="text-align: right;">458.2876</td>
<td style="text-align: right;">527.7189</td>
<td style="text-align: right;">371.5942</td>
<td style="text-align: right;">165.6750</td>
<td style="text-align: right;">51.8628</td>
<td style="text-align: right;">77.5516</td>
<td style="text-align: right;">8.2480</td>
<td style="text-align: right;">18.5389</td>
</tr>
<tr class="even">
<td style="text-align: right;">767.9883</td>
<td style="text-align: right;">824.5143</td>
<td style="text-align: right;">871.2918</td>
<td style="text-align: right;">555.9253</td>
<td style="text-align: right;">355.0071</td>
<td style="text-align: right;">178.8870</td>
<td style="text-align: right;">48.6651</td>
<td style="text-align: right;">25.0049</td>
<td style="text-align: right;">18.2817</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">740.5795</td>
<td style="text-align: right;">875.2173</td>
<td style="text-align: right;">730.0535</td>
<td style="text-align: right;">564.6748</td>
<td style="text-align: right;">290.9975</td>
<td style="text-align: right;">216.1908</td>
<td style="text-align: right;">88.8734</td>
<td style="text-align: right;">22.4157</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">862.1196</td>
<td style="text-align: right;">892.7845</td>
<td style="text-align: right;">779.8732</td>
<td style="text-align: right;">736.0763</td>
<td style="text-align: right;">469.0360</td>
<td style="text-align: right;">263.1126</td>
<td style="text-align: right;">122.3048</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">840.9417</td>
<td style="text-align: right;">1018.0836</td>
<td style="text-align: right;">945.5200</td>
<td style="text-align: right;">640.8013</td>
<td style="text-align: right;">505.1243</td>
<td style="text-align: right;">235.4820</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">848.0050</td>
<td style="text-align: right;">1204.9170</td>
<td style="text-align: right;">1023.2159</td>
<td style="text-align: right;">784.8932</td>
<td style="text-align: right;">490.5458</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">901.7740</td>
<td style="text-align: right;">1026.1131</td>
<td style="text-align: right;">1075.7020</td>
<td style="text-align: right;">877.8282</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">935.1987</td>
<td style="text-align: right;">1168.7787</td>
<td style="text-align: right;">1077.7732</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">759.3247</td>
<td style="text-align: right;">825.5859</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">723.3028</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3" data-number="4.3"><h3 data-number="4.3" id="exposure-counts">
<span class="header-section-number">4.3</span> Exposure Counts<a class="anchor" aria-label="anchor" href="#exposure-counts"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposure_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  `Accident Year` <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">size</span>,</span>
<span>  `Exposure (dnom)` <span class="op">=</span> <span class="va">dnom</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">exposure_df</span>, caption <span class="op">=</span> <span class="st">"Exposure Counts by Accident Year"</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top">
<caption>Exposure Counts by Accident Year</caption>
<thead><tr class="header">
<th style="text-align: right;">Accident.Year</th>
<th style="text-align: right;">Exposure..dnom.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">39161.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">38672.46</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">41801.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">42263.28</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">41480.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">40214.39</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">43598.51</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">42118.32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">43479.42</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">49492.41</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section class="level2" data-number="5"><h2 data-number="5" id="model-fitting">
<span class="header-section-number">5</span> Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>We now fit all five models using the package functions.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up required matrices</span></span>
<span><span class="va">rowNum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">A0</span><span class="op">)</span></span>
<span><span class="va">colNum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">A0</span><span class="op">)</span></span>
<span><span class="va">logd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">dnom</span>, <span class="va">size</span>, <span class="va">size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Upper triangle mask</span></span>
<span><span class="va">upper_triangle_mask</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">rowNum</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">colNum</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Diagonal masks</span></span>
<span><span class="va">msd</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">rowNum</span><span class="op">)</span> <span class="op">==</span> <span class="va">colNum</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">msn</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">rowNum</span><span class="op">)</span> <span class="op">==</span> <span class="va">colNum</span> <span class="op">-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Amount paid to date</span></span>
<span><span class="va">paid_to_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">B0</span> <span class="op">*</span> <span class="va">msd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<section class="level3" data-number="5.1"><h3 data-number="5.1" id="fitting-the-chain-ladder-model">
<span class="header-section-number">5.1</span> Fitting the Chain Ladder Model<a class="anchor" aria-label="anchor" href="#fitting-the-chain-ladder-model"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chain_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chain.html">chain</a></span><span class="op">(</span><span class="va">B0</span>, <span class="va">paid_to_date</span>, <span class="va">upper_triangle_mask</span><span class="op">)</span></span>
<span><span class="va">g_chain</span> <span class="op">&lt;-</span> <span class="va">chain_model</span><span class="op">$</span><span class="va">g_obj</span></span>
<span><span class="va">a0_chain</span> <span class="op">&lt;-</span> <span class="va">chain_model</span><span class="op">$</span><span class="va">a0</span></span>
<span></span>
<span><span class="co"># Create objective function wrapper for optim</span></span>
<span><span class="va">nll_chain</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/make_negative_log_likelihood.html">make_negative_log_likelihood</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">A0</span>, <span class="va">dnom</span>, <span class="va">g_chain</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Optimize</span></span>
<span><span class="va">fit_chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a0_chain</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">nll_chain</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section class="level3" data-number="5.2"><h3 data-number="5.2" id="fitting-the-cape-cod-model">
<span class="header-section-number">5.2</span> Fitting the Cape Cod Model<a class="anchor" aria-label="anchor" href="#fitting-the-cape-cod-model"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">capecod_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/capecod.html">capecod</a></span><span class="op">(</span><span class="va">B0</span>, <span class="va">paid_to_date</span>, <span class="va">upper_triangle_mask</span><span class="op">)</span></span>
<span><span class="va">g_capecod</span> <span class="op">&lt;-</span> <span class="va">capecod_model</span><span class="op">$</span><span class="va">g_obj</span></span>
<span><span class="va">a0_capecod</span> <span class="op">&lt;-</span> <span class="va">capecod_model</span><span class="op">$</span><span class="va">a0</span></span>
<span></span>
<span><span class="va">nll_capecod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/make_negative_log_likelihood.html">make_negative_log_likelihood</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">A0</span>, <span class="va">dnom</span>, <span class="va">g_capecod</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fit_capecod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a0_capecod</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">nll_capecod</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section class="level3" data-number="5.3"><h3 data-number="5.3" id="fitting-the-berquist-sherman-model">
<span class="header-section-number">5.3</span> Fitting the Berquist-Sherman Model<a class="anchor" aria-label="anchor" href="#fitting-the-berquist-sherman-model"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">berquist_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/berquist.html">berquist</a></span><span class="op">(</span><span class="va">B0</span>, <span class="va">paid_to_date</span>, <span class="va">upper_triangle_mask</span><span class="op">)</span></span>
<span><span class="va">g_berquist</span> <span class="op">&lt;-</span> <span class="va">berquist_model</span><span class="op">$</span><span class="va">g_obj</span></span>
<span><span class="va">a0_berquist</span> <span class="op">&lt;-</span> <span class="va">berquist_model</span><span class="op">$</span><span class="va">a0</span></span>
<span></span>
<span><span class="va">nll_berquist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/make_negative_log_likelihood.html">make_negative_log_likelihood</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">A0</span>, <span class="va">dnom</span>, <span class="va">g_berquist</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fit_berquist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a0_berquist</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">nll_berquist</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section class="level3" data-number="5.4"><h3 data-number="5.4" id="fitting-the-hoerl-model">
<span class="header-section-number">5.4</span> Fitting the Hoerl Model<a class="anchor" aria-label="anchor" href="#fitting-the-hoerl-model"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hoerl_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hoerl.html">hoerl</a></span><span class="op">(</span><span class="va">B0</span>, <span class="va">paid_to_date</span>, <span class="va">upper_triangle_mask</span><span class="op">)</span></span>
<span><span class="va">g_hoerl</span> <span class="op">&lt;-</span> <span class="va">hoerl_model</span><span class="op">$</span><span class="va">g_obj</span></span>
<span><span class="va">a0_hoerl</span> <span class="op">&lt;-</span> <span class="va">hoerl_model</span><span class="op">$</span><span class="va">a0</span></span>
<span></span>
<span><span class="va">nll_hoerl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/make_negative_log_likelihood.html">make_negative_log_likelihood</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">A0</span>, <span class="va">dnom</span>, <span class="va">g_hoerl</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fit_hoerl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a0_hoerl</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">nll_hoerl</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section class="level3" data-number="5.5"><h3 data-number="5.5" id="fitting-the-wright-model">
<span class="header-section-number">5.5</span> Fitting the Wright Model<a class="anchor" aria-label="anchor" href="#fitting-the-wright-model"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wright_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wright.html">wright</a></span><span class="op">(</span><span class="va">B0</span>, <span class="va">paid_to_date</span>, <span class="va">upper_triangle_mask</span><span class="op">)</span></span>
<span><span class="va">g_wright</span> <span class="op">&lt;-</span> <span class="va">wright_model</span><span class="op">$</span><span class="va">g_obj</span></span>
<span><span class="va">a0_wright</span> <span class="op">&lt;-</span> <span class="va">wright_model</span><span class="op">$</span><span class="va">a0</span></span>
<span></span>
<span><span class="va">nll_wright</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/make_negative_log_likelihood.html">make_negative_log_likelihood</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">A0</span>, <span class="va">dnom</span>, <span class="va">g_wright</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fit_wright</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a0_wright</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  fn <span class="op">=</span> <span class="va">nll_wright</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section></section><section class="level2" data-number="6"><h2 data-number="6" id="parameter-estimates">
<span class="header-section-number">6</span> Parameter Estimates<a class="anchor" aria-label="anchor" href="#parameter-estimates"></a>
</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract number of model parameters (excluding kappa and p)</span></span>
<span><span class="va">n_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  Chain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_chain</span><span class="op">)</span>,</span>
<span>  CapeCod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_capecod</span><span class="op">)</span>,</span>
<span>  Berquist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_berquist</span><span class="op">)</span>,</span>
<span>  Hoerl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_hoerl</span><span class="op">)</span>,</span>
<span>  Wright <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_wright</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">param_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">n_params</span><span class="op">)</span>,</span>
<span>  `Model Parameters` <span class="op">=</span> <span class="va">n_params</span>,</span>
<span>  `Total Parameters` <span class="op">=</span> <span class="va">n_params</span> <span class="op">+</span> <span class="fl">2</span>,</span>
<span>  `Neg Log-Likelihood` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_chain</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_capecod</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_berquist</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_hoerl</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_wright</span><span class="op">$</span><span class="va">value</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Converged <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_chain</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>    <span class="va">fit_capecod</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>    <span class="va">fit_berquist</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>    <span class="va">fit_hoerl</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>    <span class="va">fit_wright</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">param_summary</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Parameter Summary by Model"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top" style="width:100%;">
<caption>Parameter Summary by Model</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 23%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Model.Parameters</th>
<th style="text-align: right;">Total.Parameters</th>
<th style="text-align: right;">Neg.Log.Likelihood</th>
<th style="text-align: left;">Converged</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Chain</td>
<td style="text-align: left;">Chain</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">CapeCod</td>
<td style="text-align: left;">CapeCod</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Berquist</td>
<td style="text-align: left;">Berquist</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hoerl</td>
<td style="text-align: left;">Hoerl</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wright</td>
<td style="text-align: left;">Wright</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">291.17</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level2" data-number="7"><h2 data-number="7" id="reserve-estimates">
<span class="header-section-number">7</span> Reserve Estimates<a class="anchor" aria-label="anchor" href="#reserve-estimates"></a>
</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lower triangle mask (future values to predict)</span></span>
<span><span class="va">lower_mask</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="va">upper_triangle_mask</span></span>
<span></span>
<span><span class="co"># Function to calculate reserve from fitted model</span></span>
<span><span class="va">calculate_reserve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">g_func</span>, <span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">E</span> <span class="op">&lt;-</span> <span class="fu">g_func</span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E</span> <span class="op">*</span> <span class="va">lower_mask</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract model parameters (excluding kappa and p)</span></span>
<span><span class="va">params_chain</span> <span class="op">&lt;-</span> <span class="va">fit_chain</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_chain</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">params_capecod</span> <span class="op">&lt;-</span> <span class="va">fit_capecod</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_capecod</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">params_berquist</span> <span class="op">&lt;-</span> <span class="va">fit_berquist</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_berquist</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">params_hoerl</span> <span class="op">&lt;-</span> <span class="va">fit_hoerl</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_hoerl</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">params_wright</span> <span class="op">&lt;-</span> <span class="va">fit_wright</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_wright</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">reserves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chain Ladder"</span>, <span class="st">"Cape Cod"</span>, <span class="st">"Berquist-Sherman"</span>, <span class="st">"Hoerl"</span>, <span class="st">"Wright"</span><span class="op">)</span>,</span>
<span>  Reserve <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">calculate_reserve</span><span class="op">(</span><span class="va">g_chain</span>, <span class="va">params_chain</span><span class="op">)</span>,</span>
<span>    <span class="fu">calculate_reserve</span><span class="op">(</span><span class="va">g_capecod</span>, <span class="va">params_capecod</span><span class="op">)</span>,</span>
<span>    <span class="fu">calculate_reserve</span><span class="op">(</span><span class="va">g_berquist</span>, <span class="va">params_berquist</span><span class="op">)</span>,</span>
<span>    <span class="fu">calculate_reserve</span><span class="op">(</span><span class="va">g_hoerl</span>, <span class="va">params_hoerl</span><span class="op">)</span>,</span>
<span>    <span class="fu">calculate_reserve</span><span class="op">(</span><span class="va">g_wright</span>, <span class="va">params_wright</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">reserves</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Reserve Estimates by Model"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top">
<caption>Reserve Estimates by Model</caption>
<thead><tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Reserve</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Chain Ladder</td>
<td style="text-align: right;">-29,166.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cape Cod</td>
<td style="text-align: right;">1,451,675.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Berquist-Sherman</td>
<td style="text-align: right;">Inf</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hoerl</td>
<td style="text-align: right;">Inf</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wright</td>
<td style="text-align: right;">8,574.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level2" data-number="8"><h2 data-number="8" id="model-comparison">
<span class="header-section-number">8</span> Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<section class="level3" data-number="8.1"><h3 data-number="8.1" id="information-criteria">
<span class="header-section-number">8.1</span> Information Criteria<a class="anchor" aria-label="anchor" href="#information-criteria"></a>
</h3>
<p>We compare models using AIC and BIC:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">AIC</mtext><mo>=</mo><mn>2</mn><mi>k</mi><mo>+</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mo>ln</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{AIC} = 2k + 2(-\ln L)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">BIC</mtext><mo>=</mo><mi>k</mi><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mo>ln</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{BIC} = k \ln(n) + 2(-\ln L)</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> is the number of parameters and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> is the number of observations.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">upper_triangle_mask</span><span class="op">)</span>  <span class="co"># Number of observations</span></span>
<span></span>
<span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chain Ladder"</span>, <span class="st">"Cape Cod"</span>, <span class="st">"Berquist-Sherman"</span>, <span class="st">"Hoerl"</span>, <span class="st">"Wright"</span><span class="op">)</span>,</span>
<span>  Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_chain</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_capecod</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_berquist</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_hoerl</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_wright</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  NegLogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_chain</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_capecod</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_berquist</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_hoerl</span><span class="op">$</span><span class="va">value</span>,</span>
<span>    <span class="va">fit_wright</span><span class="op">$</span><span class="va">value</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_comparison</span><span class="op">$</span><span class="va">AIC</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">model_comparison</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">+</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="va">model_comparison</span><span class="op">$</span><span class="va">NegLogLik</span></span>
<span><span class="va">model_comparison</span><span class="op">$</span><span class="va">BIC</span> <span class="op">&lt;-</span> <span class="va">model_comparison</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="va">model_comparison</span><span class="op">$</span><span class="va">NegLogLik</span></span>
<span></span>
<span><span class="co"># Rank by AIC</span></span>
<span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="va">model_comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">model_comparison</span><span class="op">$</span><span class="va">AIC_Rank</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">model_comparison</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Model Comparison using Information Criteria"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top">
<caption>Model Comparison using Information Criteria</caption>
<thead><tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Parameters</th>
<th style="text-align: right;">NegLogLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AIC_Rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hoerl</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">14.00</td>
<td style="text-align: right;">28.05</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chain Ladder</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22.00</td>
<td style="text-align: right;">44.08</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Berquist-Sherman</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">26.00</td>
<td style="text-align: right;">52.10</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cape Cod</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">42.00</td>
<td style="text-align: right;">84.15</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wright</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">291.17</td>
<td style="text-align: right;">612.33</td>
<td style="text-align: right;">642.44</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3" data-number="8.2"><h3 data-number="8.2" id="visual-comparison-of-reserves">
<span class="header-section-number">8.2</span> Visual Comparison of Reserves<a class="anchor" aria-label="anchor" href="#visual-comparison-of-reserves"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Handle potential NA/Inf values</span></span>
<span><span class="va">reserve_vals</span> <span class="op">&lt;-</span> <span class="va">reserves</span><span class="op">$</span><span class="va">Reserve</span></span>
<span><span class="va">reserve_vals</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">reserve_vals</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="va">reserve_vals</span>,</span>
<span>  names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chain"</span>, <span class="st">"CapeCod"</span>, <span class="st">"Berquist"</span>, <span class="st">"Hoerl"</span>, <span class="st">"Wright"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkorange"</span>, <span class="st">"purple"</span>, <span class="st">"darkred"</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Reserve Estimates by Model"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Reserve Amount"</span>,</span>
<span>  las <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">reserves</span><span class="op">$</span><span class="va">Reserve</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">reserves</span><span class="op">$</span><span class="va">Reserve</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="st">"Mean Reserve"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray40"</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-reserve-comparison" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-reserve-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hayne_paper_reproduction_files/figure-html/fig-reserve-comparison-1.png" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reserve-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: Reserve Estimates by Model
</figcaption></figure>
</div>
</div>
</div>
</section></section><section class="level2" data-number="9"><h2 data-number="9" id="residual-diagnostics">
<span class="header-section-number">9</span> Residual Diagnostics<a class="anchor" aria-label="anchor" href="#residual-diagnostics"></a>
</h2>
<section class="level3" data-number="9.1"><h3 data-number="9.1" id="chain-ladder-residuals">
<span class="header-section-number">9.1</span> Chain Ladder Residuals<a class="anchor" aria-label="anchor" href="#chain-ladder-residuals"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate fitted values and residuals</span></span>
<span><span class="va">E_chain</span> <span class="op">&lt;-</span> <span class="fu">g_chain</span><span class="op">(</span><span class="va">params_chain</span><span class="op">)</span></span>
<span><span class="va">residuals_chain</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">A0</span> <span class="op">-</span> <span class="va">E_chain</span><span class="op">)</span> <span class="op">*</span> <span class="va">upper_triangle_mask</span></span>
<span><span class="va">residuals_chain</span><span class="op">[</span><span class="op">!</span><span class="va">upper_triangle_mask</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># Standardized residuals</span></span>
<span><span class="va">kappa</span> <span class="op">&lt;-</span> <span class="va">fit_chain</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_chain</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">fit_chain</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_chain</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">var_chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">kappa</span> <span class="op">-</span> <span class="va">logd</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">E_chain</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">1e-10</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="va">p</span></span>
<span><span class="va">std_resid_chain</span> <span class="op">&lt;-</span> <span class="va">residuals_chain</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">var_chain</span>, <span class="fl">1e-10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">std_resid_chain</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">std_resid_chain</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Q-Q plot</span></span>
<span><span class="va">std_resid_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">std_resid_chain</span><span class="op">)</span></span>
<span><span class="va">std_resid_vec</span> <span class="op">&lt;-</span> <span class="va">std_resid_vec</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">std_resid_vec</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">std_resid_vec</span>, main <span class="op">=</span> <span class="st">"Q-Q Plot: Chain Ladder"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqline</a></span><span class="op">(</span><span class="va">std_resid_vec</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Residuals vs Fitted</span></span>
<span><span class="va">fitted_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">E_chain</span><span class="op">[</span><span class="va">upper_triangle_mask</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">resid_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">std_resid_chain</span><span class="op">[</span><span class="va">upper_triangle_mask</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">valid_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">fitted_vals</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">resid_vals</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fitted_vals</span><span class="op">[</span><span class="va">valid_idx</span><span class="op">]</span>,</span>
<span>  <span class="va">resid_vals</span><span class="op">[</span><span class="va">valid_idx</span><span class="op">]</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Fitted Values"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Standardized Residuals"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Residuals vs Fitted"</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Residuals by Development Lag</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span></span>
<span>  <span class="va">std_resid_chain</span>,</span>
<span>  names <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">size</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Development Lag"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Standardized Residuals"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Residuals by Development Lag"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"lightblue"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Residuals by Calendar Year</span></span>
<span><span class="va">cal_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">A0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">A0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">resid_by_cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">std_resid_chain</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">cal_year</span><span class="op">)</span>,</span>
<span>  <span class="va">mean</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="va">resid_by_cal</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Calendar Year"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Mean Standardized Residual"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Residuals by Calendar Year"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"lightgreen"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-residuals-chain" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-residuals-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hayne_paper_reproduction_files/figure-html/fig-residuals-chain-1.png" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: Chain Ladder Model Residuals
</figcaption></figure>
</div>
</div>
</div>
</section></section><section class="level2" data-number="10"><h2 data-number="10" id="simulation-and-uncertainty">
<span class="header-section-number">10</span> Simulation and Uncertainty<a class="anchor" aria-label="anchor" href="#simulation-and-uncertainty"></a>
</h2>
<section class="level3" data-number="10.1"><h3 data-number="10.1" id="monte-carlo-simulation">
<span class="header-section-number">10.1</span> Monte Carlo Simulation<a class="anchor" aria-label="anchor" href="#monte-carlo-simulation"></a>
</h3>
<p>We use the Fisher information matrix to simulate parameter uncertainty and estimate the distribution of reserves.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_sim</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span></span>
<span><span class="co"># Use Chain Ladder for simulation example</span></span>
<span><span class="va">params_full</span> <span class="op">&lt;-</span> <span class="va">fit_chain</span><span class="op">$</span><span class="va">par</span></span>
<span><span class="va">hessian_chain</span> <span class="op">&lt;-</span> <span class="va">fit_chain</span><span class="op">$</span><span class="va">hessian</span></span>
<span></span>
<span><span class="co"># Variance-covariance matrix from Hessian (Fisher information approximation)</span></span>
<span><span class="va">vcov_chain</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">hessian_chain</span><span class="op">)</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># If Hessian is singular, use pseudo-inverse</span></span>
<span>    <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">ginv</a></span><span class="op">(</span><span class="va">hessian_chain</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure positive definiteness</span></span>
<span><span class="va">vcov_chain</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">vcov_chain</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">vcov_chain</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">vcov_chain</span><span class="op">)</span></span>
<span><span class="va">eig</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">eig</span><span class="op">$</span><span class="va">values</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span></span>
<span><span class="va">vcov_chain</span> <span class="op">&lt;-</span> <span class="va">eig</span><span class="op">$</span><span class="va">vectors</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">eig</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">eig</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate parameters</span></span>
<span><span class="va">sim_params</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n_sim</span>, <span class="va">params_full</span>, <span class="va">vcov_chain</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate reserves for each simulation</span></span>
<span><span class="va">sim_reserves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_sim</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">model_params</span> <span class="op">&lt;-</span> <span class="va">sim_params</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a0_chain</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">sim_reserves</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">calculate_reserve</span><span class="op">(</span><span class="va">g_chain</span>, <span class="va">model_params</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details>
</div>
</section><section class="level3" data-number="10.2"><h3 data-number="10.2" id="distribution-of-reserve-estimates">
<span class="header-section-number">10.2</span> Distribution of Reserve Estimates<a class="anchor" aria-label="anchor" href="#distribution-of-reserve-estimates"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_reserves</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Distribution of Reserve Estimates"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Reserve Amount"</span>,</span>
<span>  freq <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add density curve</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">sim_reserves</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkred"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add confidence interval lines</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sim_reserves</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">ci</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topright"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Density"</span>, <span class="st">"Median"</span>, <span class="st">"95% CI"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-reserve-distribution" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-reserve-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hayne_paper_reproduction_files/figure-html/fig-reserve-distribution-1.png" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reserve-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: Distribution of Simulated Reserves (Chain Ladder)
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level3" data-number="10.3"><h3 data-number="10.3" id="summary-statistics">
<span class="header-section-number">10.3</span> Summary Statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Mean Reserve"</span>,</span>
<span>    <span class="st">"Median Reserve"</span>,</span>
<span>    <span class="st">"Standard Error"</span>,</span>
<span>    <span class="st">"Coefficient of Variation"</span>,</span>
<span>    <span class="st">"2.5% Quantile"</span>,</span>
<span>    <span class="st">"97.5% Quantile"</span>,</span>
<span>    <span class="st">"95% Confidence Interval Width"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_reserves</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sim_reserves</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sim_reserves</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sim_reserves</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_reserves</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sim_reserves</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sim_reserves</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">sim_reserves</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_summary</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Monte Carlo Simulation Summary (Chain Ladder, 5,000 iterations)"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<table class="table caption-top">
<caption>Monte Carlo Simulation Summary (Chain Ladder, 5,000 iterations)</caption>
<thead><tr class="header">
<th style="text-align: left;">Statistic</th>
<th style="text-align: right;">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean Reserve</td>
<td style="text-align: right;">-29,166.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Median Reserve</td>
<td style="text-align: right;">-29,166.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Standard Error</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Coefficient of Variation</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.5% Quantile</td>
<td style="text-align: right;">-29,166.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">97.5% Quantile</td>
<td style="text-align: right;">-29,166.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% Confidence Interval Width</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section class="level2" data-number="11"><h2 data-number="11" id="conclusion">
<span class="header-section-number">11</span> Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette has reproduced the key elements of Hayne’s flexible framework:</p>
<ol type="1">
<li><p><strong>Theoretical Foundation</strong>: The unified likelihood-based approach enables consistent parameter estimation and uncertainty quantification across all five reserving methods.</p></li>
<li><p><strong>Model Comparison</strong>: Information criteria (AIC/BIC) provide objective model selection guidance.</p></li>
<li><p><strong>Uncertainty Quantification</strong>: The Fisher information matrix and Monte Carlo simulation enable probabilistic reserve estimates with confidence intervals.</p></li>
<li><p><strong>Practical Implementation</strong>: The <code>stochasticreserver</code> package provides ready-to-use functions for all five models with gradient and Hessian computations for efficient optimization.</p></li>
</ol></section><section class="level2" data-number="12"><h2 data-number="12" id="references">
<span class="header-section-number">12</span> References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hayne2012" class="csl-entry" role="listitem">
Hayne, Roger M. 2012. <span>“A Flexible Framework for Stochastic Reserving Models.”</span> <em>Variance</em> 7 (2): 123–51. <a href="https://variancejournal.org/article/120823" class="external-link">https://variancejournal.org/article/120823</a>.
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Hayne, R. Mark Sharp.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>



  <script>
document.addEventListener('DOMContentLoaded', function() {
  var codeBlocks = document.querySelectorAll('div.sourceCode');
  codeBlocks.forEach(function(block) {
    var btn = document.createElement('button');
    btn.className = 'code-fold-btn';
    btn.innerHTML = '&#9654; Show Code';
    btn.onclick = function() {
      if (block.classList.contains('hidden')) {
        block.classList.remove('hidden');
        btn.innerHTML = '&#9660; Hide Code';
      } else {
        block.classList.add('hidden');
        btn.innerHTML = '&#9654; Show Code';
      }
    };
    block.classList.add('hidden');
    block.parentNode.insertBefore(btn, block);
  });
});
</script>
</body>
</html>
